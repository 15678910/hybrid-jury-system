import{C as ee,r as o,j as e,S as te,K as se,F as ae,X as oe,I as re,T as le,D as ne,c as L,d as F,q as B,o as R,l as _,g as A,s as ie}from"./index-BRv2x-XL.js";import{H as ce}from"./Header-DKW4VDud.js";const P="videos_cache",de=30*60*1e3,he=()=>{try{const l=localStorage.getItem(P);if(l){const{data:c,timestamp:n}=JSON.parse(l),h=Date.now()-n>=de;return{data:c,isStale:h}}}catch(l){console.log("Cache read error:",l)}return null},q=l=>{try{localStorage.setItem(P,JSON.stringify({data:l,timestamp:Date.now()}))}catch(c){console.log("Cache write error:",c)}},z=l=>{const c=[/(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,/youtube\.com\/shorts\/([^&\n?#]+)/];for(const n of c){const h=l.match(n);if(h)return h[1]}return null};function xe(){const[l,c]=ee(),n=l.get("v");o.useRef({});const[h,y]=o.useState(!1),[v,N]=o.useState(null),[k,S]=o.useState(""),w=he(),p=(w==null?void 0:w.data)||null,[m,f]=o.useState(p||[]),[b,H]=o.useState(!p),[O,I]=o.useState(!1),[g,C]=o.useState(null),[T,i]=o.useState(null),[j,$]=o.useState(!1),[V,E]=o.useState(!0),[M,U]=o.useState(null),x=9;o.useEffect(()=>{if(n&&!b){const t=m.find(s=>(s.videoId||z(s.url))===n);N(n),S((t==null?void 0:t.title)||"동영상"),y(!0)}},[n,b,m]);const D=()=>{y(!1),N(null),S(""),c({})};o.useEffect(()=>{const t=setTimeout(()=>{var s;if(window.Kakao&&!window.Kakao.isInitialized())try{window.Kakao.init("83e843186c1251b9b5a8013fd5f29798"),I(!0)}catch(a){console.error("Kakao init error:",a)}else(s=window.Kakao)!=null&&s.isInitialized()&&I(!0)},1e3);return()=>clearTimeout(t)},[]);const W=(t,s)=>{var r;const a=`https://xn--lg3b0kt4n41f.kr/videos?v=${s}`;if(O&&((r=window.Kakao)!=null&&r.isInitialized()))try{window.Kakao.Share.sendDefault({objectType:"feed",content:{title:t.title,description:t.description||"시민법정 - 참심제와 사법개혁",imageUrl:`https://img.youtube.com/vi/${s}/maxresdefault.jpg`,link:{mobileWebUrl:a,webUrl:a}},buttons:[{title:"동영상 보기",link:{mobileWebUrl:a,webUrl:a}}]})}catch(d){console.error("Kakao share error:",d),K(t.title,a)}else K(t.title,a)},K=(t,s)=>{navigator.clipboard.writeText(`${t}
${s}`),alert(`링크가 복사되었습니다!
카카오톡에 붙여넣기 해주세요.`)},X=(t,s)=>{const a=`https://youtu.be/${s}`,r=`${t.title}
${a}`;navigator.clipboard.writeText(r),alert(`링크가 복사되었습니다!
페이스북에 붙여넣기 해주세요.`),window.open("https://www.facebook.com/","_blank")},J=(t,s)=>{const a=`https://youtu.be/${s}`,r=`${t.title}

${a}

#시민법정 #참심제 #사법개혁`;navigator.clipboard.writeText(r),alert(`텍스트가 복사되었습니다!
X에서 붙여넣기 해주세요.`),window.open("https://x.com/","_blank")},Y=(t,s)=>{const a=`https://youtu.be/${s}`;navigator.clipboard.writeText(a),C(s),setTimeout(()=>C(null),2e3)},G=(t,s)=>{const a=`https://youtu.be/${s}`;navigator.clipboard.writeText(`${t.title} ${a}`),alert(`텍스트가 복사되었습니다!
인스타그램 스토리나 게시물에 붙여넣기 해주세요.`),window.open("https://www.instagram.com/","_blank")},Q=(t,s)=>{const a=`https://siminbupjung-blog.web.app/v/${s}`;window.open(`https://t.me/share/url?url=${encodeURIComponent(a)}&text=${encodeURIComponent(t.title)}`,"_blank")};o.useEffect(()=>{(async()=>{try{const s=L(F,"videos"),a=B(s,R("createdAt","desc"),_(x)),r=await A(a),d=r.docs.map(u=>({id:u.id,...u.data()}));q(d),f(d),U(r.docs[r.docs.length-1]),E(r.docs.length>=x)}catch(s){console.error("Error fetching videos:",s),p||f([])}finally{H(!1)}})()},[]);const Z=async()=>{if(!(j||!V||!M)){$(!0);try{const t=L(F,"videos"),s=B(t,R("createdAt","desc"),ie(M),_(x)),a=await A(s),r=a.docs.map(u=>({id:u.id,...u.data()})),d=[...m,...r];f(d),q(d),U(a.docs[a.docs.length-1]),E(a.docs.length>=x)}catch(t){console.error("Error loading more videos:",t)}finally{$(!1)}}};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(ce,{}),h&&v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80",onClick:D,children:e.jsxs("div",{className:"relative w-full max-w-4xl mx-4",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:D,className:"absolute -top-12 right-0 text-white hover:text-gray-300 transition-colors",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-white text-lg font-bold mb-3 truncate",children:k}),e.jsx("div",{className:"aspect-video bg-black rounded-lg overflow-hidden",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${v}?autoplay=1`,title:k,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})]})}),e.jsx("main",{className:"pt-24 pb-16 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"동영상"}),e.jsx("p",{className:"text-gray-600",children:"참심제와 사법개혁 관련 영상을 시청하세요"})]}),b?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-red-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"동영상을 불러오는 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(t=>{const s=t.videoId||z(t.url);return e.jsxs("div",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-all relative",children:[e.jsx("div",{className:"aspect-video overflow-hidden rounded-t-xl",children:e.jsx("iframe",{src:`https://www.youtube.com/embed/${s}`,title:t.title,className:"w-full h-full",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"font-bold text-gray-900 line-clamp-2 flex-1",children:t.title}),e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("button",{onClick:()=>i(T===s?null:s),className:"w-8 h-8 flex items-center justify-center text-gray-500 hover:text-blue-600 hover:bg-gray-100 rounded-full transition-colors",title:"공유",children:e.jsx(te,{className:"w-5 h-5"})}),T===s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(null)}),e.jsxs("div",{className:"absolute right-0 top-10 bg-white rounded-xl shadow-2xl border p-4 z-50",style:{minWidth:"220px"},children:[e.jsx("p",{className:"text-sm text-gray-700 mb-3 font-medium",children:"공유하기"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{onClick:()=>{W(t,s),i(null)},className:"w-11 h-11 flex items-center justify-center bg-[#FEE500] rounded-full hover:scale-110 transition-transform shadow-md",title:"카카오톡",children:e.jsx(se,{className:"w-6 h-6 text-[#391B1B]"})}),e.jsx("button",{onClick:()=>{X(t,s),i(null)},className:"w-11 h-11 flex items-center justify-center bg-[#1877F2] rounded-full hover:scale-110 transition-transform shadow-md",title:"페이스북",children:e.jsx(ae,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:()=>{J(t,s),i(null)},className:"w-11 h-11 flex items-center justify-center bg-black rounded-full hover:scale-110 transition-transform shadow-md",title:"X",children:e.jsx(oe,{className:"w-5 h-5 text-white"})}),e.jsx("button",{onClick:()=>{G(t,s),i(null)},className:"w-11 h-11 flex items-center justify-center bg-gradient-to-br from-[#F58529] via-[#DD2A7B] to-[#515BD4] rounded-full hover:scale-110 transition-transform shadow-md",title:"인스타그램",children:e.jsx(re,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:()=>{Q(t,s),i(null)},className:"w-11 h-11 flex items-center justify-center bg-[#0088cc] rounded-full hover:scale-110 transition-transform shadow-md",title:"텔레그램",children:e.jsx(le,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:()=>{Y(t,s),i(null)},className:`w-11 h-11 flex items-center justify-center rounded-full hover:scale-110 transition-all shadow-md ${g===s?"bg-green-500":"bg-gray-600"}`,title:g===s?"복사됨!":"링크 복사",children:g===s?e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx(ne,{className:"w-6 h-6 text-white"})})]})]})]})]})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mt-2",children:t.description})]})]},t.id)})}),m.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"등록된 동영상이 없습니다."}),V&&m.length>0&&e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{onClick:Z,disabled:j,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:j?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"불러오는 중..."]}):"더 보기"})})]})]})}),e.jsx("footer",{className:"bg-gray-900 text-gray-400 py-6 px-4",children:e.jsx("div",{className:"container mx-auto text-center",children:e.jsx("p",{children:"© 주권자사법개혁추진준비위원회"})})})]})}export{xe as default};
