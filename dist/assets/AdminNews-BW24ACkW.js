import{r as d,c as y,d as x,q as g,x as m,g as p,j as e,o as D,a as k,b as A}from"./index-BRv2x-XL.js";import{H as v}from"./Header-DKW4VDud.js";function W(){const[h,o]=d.useState(!1),[a,u]=d.useState(""),[S,n]=d.useState(""),[f,b]=d.useState([]),[C,j]=d.useState(!1),w=async()=>{if(!a.trim()){alert("작성자 코드를 입력해주세요.");return}const t="SbAdmin2025!",r="SbWriter2025!";if(a===t){o(!0),n("관리자"),localStorage.setItem("writerCode",a);return}if(a===r){o(!0),n("시민법정"),localStorage.setItem("writerCode",a);return}try{const c=y(x,"writerCodes"),i=g(c,m("code","==",a),m("active","==",!0)),l=await p(i);if(l.empty)alert("유효하지 않은 작성자 코드입니다.");else{const s=l.docs[0].data();o(!0),n(s.name),localStorage.setItem("writerCode",a)}}catch(c){console.error("Error verifying code:",c),alert("인증 중 오류가 발생했습니다.")}};d.useEffect(()=>{const t=localStorage.getItem("writerCode");if(t){u(t);const r="SbAdmin2025!",c="SbWriter2025!";if(t===r){o(!0),n("관리자");return}if(t===c){o(!0),n("시민법정");return}(async()=>{try{const i=y(x,"writerCodes"),l=g(i,m("code","==",t),m("active","==",!0)),s=await p(l);s.empty||(o(!0),n(s.docs[0].data().name))}catch(i){console.error("Auto login error:",i)}})()}},[]),d.useEffect(()=>{if(!h)return;(async()=>{j(!0);try{const r=y(x,"posts"),c=g(r,D("createdAt","desc")),l=(await p(c)).docs.filter(s=>s.data().category==="사법뉴스").map(s=>{var N;return{id:s.id,...s.data(),date:((N=s.data().createdAt)==null?void 0:N.toDate().toLocaleDateString("ko-KR"))||""}});b(l)}catch(r){console.error("Error fetching news:",r)}finally{j(!1)}})()},[h]);const E=async t=>{if(window.confirm("정말 삭제하시겠습니까?"))try{await k(A(x,"posts",t)),b(f.filter(r=>r.id!==t)),alert("삭제되었습니다.")}catch(r){console.error("Error deleting:",r),alert("삭제 중 오류가 발생했습니다.")}},q=()=>{localStorage.removeItem("writerCode"),o(!1),u(""),n("")};return h?e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(v,{}),e.jsx("main",{className:"pt-24 pb-16 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-4xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"사법뉴스 관리"}),e.jsxs("p",{className:"text-gray-500",children:[S,"님으로 로그인됨"]})]}),e.jsx("button",{onClick:q,className:"text-gray-500 hover:text-gray-700",children:"로그아웃"})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:C?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"불러오는 중..."}):f.length===0?e.jsx("div",{className:"p-8 text-center text-gray-500",children:"수집된 사법뉴스가 없습니다."}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"제목"}),e.jsx("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-500",children:"날짜"}),e.jsx("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-500",children:"관리"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:f.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("a",{href:`/blog/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-gray-900 hover:text-blue-600",children:t.title})}),e.jsx("td",{className:"px-6 py-4 text-gray-500",children:t.date}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>E(t.id),className:"text-red-600 hover:text-red-800",children:"삭제"})})]},t.id))})]})})]})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(v,{}),e.jsx("main",{className:"pt-24 pb-16 px-4",children:e.jsx("div",{className:"container mx-auto max-w-md",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"사법뉴스 관리"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("input",{type:"text",value:a,onChange:t=>u(t.target.value),placeholder:"작성자 코드 입력",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyDown:t=>t.key==="Enter"&&w()}),e.jsx("button",{onClick:w,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"확인"})]})]})})})]})}export{W as default};
