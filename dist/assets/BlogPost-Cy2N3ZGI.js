import{f as re,h as oe,r as l,j as e,L as T,K as le,F as ie,X as ce,I as de,T as me,i as he,k as xe,b as E,d as b,m as ue,c as C,q as F,o as B,g as W,u as pe,n as ge,e as be,p as fe}from"./index-BRv2x-XL.js";import{H as we}from"./Header-DKW4VDud.js";function Ne(){const{id:c}=re(),z=oe(),[s,N]=l.useState(null),[f,q]=l.useState([]),[H,O]=l.useState(!0),[L,D]=l.useState(!1),[X,$]=l.useState(0),[u,R]=l.useState(!1),[w,P]=l.useState([]),[i,v]=l.useState({nickname:"",content:""}),[U,_]=l.useState(!1);l.useEffect(()=>{const t=()=>{var a;if(window.Kakao&&!window.Kakao.isInitialized())try{window.Kakao.init("83e843186c1251b9b5a8013fd5f29798"),console.log("Kakao SDK initialized"),D(!0)}catch(n){console.error("Kakao init error:",n)}else(a=window.Kakao)!=null&&a.isInitialized()&&D(!0)};if(window.Kakao)t();else{const a=setInterval(()=>{window.Kakao&&(clearInterval(a),t())},100);setTimeout(()=>clearInterval(a),5e3)}},[]),l.useEffect(()=>{(async()=>{var a;try{const n=E(b,"posts",c),r=await ue(n);if(r.exists()){const k={id:r.id,...r.data(),date:((a=r.data().createdAt)==null?void 0:a.toDate().toLocaleDateString("ko-KR"))||""};N(k),$(k.likes||0);const x=JSON.parse(localStorage.getItem("likedPosts")||"[]");R(x.includes(c));const d=C(b,"posts",c,"comments"),y=F(d,B("createdAt","desc")),K=(await W(y)).docs.map(h=>{var g;return{id:h.id,...h.data(),date:((g=h.data().createdAt)==null?void 0:g.toDate().toLocaleDateString("ko-KR"))||""}});P(K);const se=C(b,"posts"),ae=F(se,B("createdAt","desc")),ne=(await W(ae)).docs.map(h=>{var g;return{id:h.id,...h.data(),date:((g=h.data().createdAt)==null?void 0:g.toDate().toLocaleDateString("ko-KR"))||""}});q(ne)}else N(null)}catch(n){console.error("Error fetching post:",n),N(null)}finally{O(!1)}})()},[c]);const J=async()=>{if(!u)try{const t=E(b,"posts",c);await pe(t,{likes:ge(1)}),$(n=>n+1),R(!0);const a=JSON.parse(localStorage.getItem("likedPosts")||"[]");a.push(c),localStorage.setItem("likedPosts",JSON.stringify(a))}catch(t){console.error("Error liking post:",t),alert("좋아요에 실패했습니다.")}},M=async t=>{if(t.preventDefault(),!i.nickname.trim()||!i.content.trim()){alert("닉네임과 내용을 입력해주세요.");return}_(!0);try{const a=C(b,"posts",c,"comments"),n=await be(a,{nickname:i.nickname.trim(),content:i.content.trim(),createdAt:fe()});P(r=>[{id:n.id,nickname:i.nickname.trim(),content:i.content.trim(),date:new Date().toLocaleDateString("ko-KR")},...r]),v({nickname:"",content:""})}catch(a){console.error("Error submitting comment:",a),alert("댓글 작성에 실패했습니다.")}finally{_(!1)}};if(H)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"글을 불러오는 중..."})]})});if(!s)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"글을 찾을 수 없습니다"}),e.jsx(T,{to:"/blog",className:"text-blue-600 hover:underline",children:"블로그 목록으로 돌아가기"})]})});const o=`https://xn--lg3b0kt4n41f.kr/blog/${s.id}`,p=`${s.title} - 시민법정`,Q=()=>{var a;console.log("Kakao SDK ready:",L),console.log("Kakao object:",window.Kakao);const t=s.summary||s.content.substring(0,100).replace(/\n/g," ")+"...";if(L&&((a=window.Kakao)!=null&&a.isInitialized()))try{window.Kakao.Share.sendDefault({objectType:"feed",content:{title:s.title,description:t,imageUrl:s.imageUrl||"https://xn--lg3b0kt4n41f.kr/og-image.jpg",link:{mobileWebUrl:o,webUrl:o}},buttons:[{title:"더 보기",link:{mobileWebUrl:o,webUrl:o}}]})}catch(n){console.error("Kakao share error:",n),A()}else console.log("Kakao SDK not ready, using fallback"),A()},A=()=>{const t=`${p}
${o}`;navigator.clipboard.writeText(t),alert(`링크가 복사되었습니다!
카카오톡에 붙여넣기 해주세요.`)},G=()=>{const t=`${s.title}
${o}`;navigator.clipboard.writeText(t),alert(`링크가 복사되었습니다!
페이스북에 붙여넣기 해주세요.`),window.open("https://www.facebook.com/","_blank")},V=()=>{const t=`${p}

${o}

#시민법정 #참심제 #사법개혁`;navigator.clipboard.writeText(t),alert(`텍스트가 복사되었습니다!
X에서 붙여넣기 해주세요.`),window.open("https://x.com/","_blank")},Y=()=>{const t=`${o}?t=${Date.now()}`;window.open(`https://t.me/share/url?url=${encodeURIComponent(t)}&text=${encodeURIComponent(p)}`,"_blank","width=600,height=400")},Z=async()=>{try{await navigator.clipboard.writeText(`${p} ${o}`),alert(`텍스트가 복사되었습니다!
인스타그램에서 스토리나 게시물에 붙여넣기 해주세요.`),window.open("https://www.instagram.com/","_blank")}catch{alert("복사에 실패했습니다. 직접 링크를 복사해주세요.")}},ee=async()=>{try{await navigator.clipboard.writeText(`${p}

${o}

#시민법정 #참심제 #사법개혁`),alert(`텍스트가 복사되었습니다!
Threads에서 붙여넣기 해주세요.`),window.open("https://www.threads.net/","_blank")}catch{alert("복사에 실패했습니다. 직접 링크를 복사해주세요.")}},te=()=>{window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(o)}`,"_blank","width=600,height=400")},j=f.findIndex(t=>t.id===s.id),S=j>0?f[j-1]:null,I=j<f.length-1?f[j+1]:null;return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(we,{}),e.jsx("main",{className:"pt-24 pb-16 px-4",children:e.jsxs("article",{className:"container mx-auto max-w-3xl",children:[e.jsxs("button",{onClick:()=>z(s.category==="사법뉴스"?"/news":"/blog"),className:"flex items-center text-gray-500 hover:text-blue-600 mb-6",children:[e.jsx("svg",{className:"w-5 h-5 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"목록으로"]}),e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:s.title}),e.jsxs("div",{className:"flex items-center text-gray-500 text-sm",children:[e.jsx("span",{children:s.author}),e.jsx("span",{className:"mx-2",children:"·"}),e.jsx("span",{children:s.date})]})]}),s.imageUrl&&s.imageUrl!=="https://siminbupjung-blog.web.app/og-image.jpg"&&e.jsx("div",{className:"mb-8",children:e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full rounded-xl shadow-md object-cover max-h-96"})}),e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 md:p-10 mb-8",children:s.content.trim().startsWith("<")?e.jsx("div",{className:"prose prose-lg max-w-none prose-headings:text-gray-900 prose-p:text-gray-700 prose-p:leading-relaxed prose-a:text-blue-600 prose-a:underline hover:prose-a:text-blue-800 prose-strong:text-gray-900 prose-ul:text-gray-700 prose-ol:text-gray-700",dangerouslySetInnerHTML:{__html:s.content}}):e.jsx("div",{className:"prose prose-lg max-w-none",children:s.content.split(`
`).map((t,a)=>{const n=r=>{const k=/(https?:\/\/[^\s<]+)/g,x=[];let d=0;const y=[...r.matchAll(k)];return y.length===0?r:(y.forEach((m,K)=>{m.index>d&&x.push(r.slice(d,m.index)),x.push(e.jsx("a",{href:m[0],target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline",children:m[0]},K)),d=m.index+m[0].length}),d<r.length&&x.push(r.slice(d)),x)};return t.trim()===""?e.jsx("br",{},a):e.jsx("p",{className:"text-gray-700 mb-4 leading-relaxed",children:n(t)},a)})})}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 mb-4 border border-blue-100",children:[e.jsxs("p",{className:"text-gray-700 mb-3",children:["온라인 준비위원으로 참여하기 ",e.jsx("a",{href:"https://시민법정.kr",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"시민법정.kr"})]}),e.jsx("p",{className:"text-gray-700 mb-3",children:"온라인 준비위원 1만명이 참여하면 광장에서 주권자 세상 시작합니다."}),e.jsxs("p",{className:"text-gray-700",children:["주권자에 의한 시민법관 참심제! ",e.jsx("a",{href:s.musicUrl||"https://youtu.be/Qu3pn7OF9vw",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"음악 듣기"})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-slate-800 to-slate-900 rounded-xl p-6 mb-4",children:[e.jsx("p",{className:"text-white text-center mb-4 font-medium",children:"이 글을 공유해주세요"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx("button",{onClick:Q,className:"w-12 h-12 flex items-center justify-center bg-[#FEE500] rounded-full hover:scale-110 transition-transform",title:"카카오톡",children:e.jsx(le,{className:"w-6 h-6 text-[#391B1B]"})}),e.jsx("button",{onClick:G,className:"w-12 h-12 flex items-center justify-center bg-[#1877F2] rounded-full hover:scale-110 transition-transform",title:"페이스북",children:e.jsx(ie,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:V,className:"w-12 h-12 flex items-center justify-center bg-black rounded-full hover:scale-110 transition-transform",title:"X",children:e.jsx(ce,{className:"w-5 h-5 text-white"})}),e.jsx("button",{onClick:Z,className:"w-12 h-12 flex items-center justify-center bg-gradient-to-br from-[#F58529] via-[#DD2A7B] to-[#515BD4] rounded-full hover:scale-110 transition-transform",title:"인스타그램",children:e.jsx(de,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:Y,className:"w-12 h-12 flex items-center justify-center bg-[#0088cc] rounded-full hover:scale-110 transition-transform",title:"텔레그램",children:e.jsx(me,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:ee,className:"w-12 h-12 flex items-center justify-center bg-black rounded-full hover:scale-110 transition-transform",title:"Threads",children:e.jsx(he,{className:"w-6 h-6 text-white"})}),e.jsx("button",{onClick:te,className:"w-12 h-12 flex items-center justify-center bg-[#0A66C2] rounded-full hover:scale-110 transition-transform",title:"LinkedIn",children:e.jsx(xe,{className:"w-6 h-6 text-white"})})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-md p-6 mb-4 text-center",children:e.jsxs("button",{onClick:J,disabled:u,className:`inline-flex items-center gap-2 px-6 py-3 rounded-full font-medium transition-all ${u?"bg-pink-100 text-pink-600 cursor-default":"bg-gray-100 text-gray-700 hover:bg-pink-50 hover:text-pink-600"}`,children:[e.jsx("svg",{className:"w-6 h-6",fill:u?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),e.jsx("span",{children:u?"감사합니다!":"좋아요"}),e.jsx("span",{className:"bg-white px-2 py-0.5 rounded-full text-sm",children:X})]})}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6 mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:["댓글 ",w.length>0&&e.jsxs("span",{className:"text-blue-600",children:["(",w.length,")"]})]}),e.jsxs("form",{onSubmit:M,className:"mb-6",children:[e.jsx("div",{className:"flex gap-2 mb-2",children:e.jsx("input",{type:"text",value:i.nickname,onChange:t=>v({...i,nickname:t.target.value}),placeholder:"닉네임",className:"w-32 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",maxLength:20})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("textarea",{value:i.content,onChange:t=>v({...i,content:t.target.value}),placeholder:"댓글을 작성해주세요",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none",rows:2,maxLength:500}),e.jsx("button",{type:"submit",disabled:U,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50 text-sm font-medium",children:U?"등록중...":"등록"})]})]}),e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsx("p",{className:"text-center text-gray-400 py-4",children:"첫 댓글을 작성해주세요!"}):w.map(t=>e.jsxs("div",{className:"border-b border-gray-100 pb-4 last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.nickname}),e.jsx("span",{className:"text-xs text-gray-400",children:t.date})]}),e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:t.content})]},t.id))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[S?e.jsxs(T,{to:`/blog/${S.id}`,className:"bg-white rounded-xl p-4 shadow hover:shadow-md transition-shadow",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"← 이전 글"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1 line-clamp-1",children:S.title})]}):e.jsx("div",{}),I&&e.jsxs(T,{to:`/blog/${I.id}`,className:"bg-white rounded-xl p-4 shadow hover:shadow-md transition-shadow text-right",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"다음 글 →"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1 line-clamp-1",children:I.title})]})]})]})}),e.jsx("footer",{className:"bg-gray-900 text-gray-400 py-6 px-4",children:e.jsx("div",{className:"container mx-auto text-center",children:e.jsx("p",{children:"© 주권자사법개혁추진준비위원회"})})})]})}export{Ne as default};
