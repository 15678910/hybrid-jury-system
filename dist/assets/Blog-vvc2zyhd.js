import{r as c,j as e,L as u,c as N,d as k,q as S,o as C,g as K,s as q,l as M}from"./index-BRv2x-XL.js";import{H as T}from"./Header-DKW4VDud.js";const E="blog_posts_cache",H=30*60*1e3,I=()=>{try{const r=localStorage.getItem(E);if(r){const{data:i,timestamp:m}=JSON.parse(r),d=Date.now()-m>=H;return{data:i,isStale:d}}}catch(r){console.log("Cache read error:",r)}return null},D=r=>{try{localStorage.setItem(E,JSON.stringify({data:r,timestamp:Date.now()}))}catch(i){console.log("Cache write error:",i)}};function V(){const r=I(),i=(r==null?void 0:r.data)||null,[m,d]=c.useState(i||[]),[L,U]=c.useState(!i),[z,f]=c.useState(!1),[x,b]=c.useState(!1),[y,j]=c.useState(!0),[v,A]=c.useState(null),p=10;c.useEffect(()=>{const t=setTimeout(()=>{var a;if(window.Kakao&&!window.Kakao.isInitialized())try{window.Kakao.init("83e843186c1251b9b5a8013fd5f29798"),f(!0)}catch(s){console.error("Kakao init error:",s)}else(a=window.Kakao)!=null&&a.isInitialized()&&f(!0)},1e3);return()=>clearTimeout(t)},[]),c.useEffect(()=>{(async()=>{try{const a=N(k,"posts"),s=S(a,C("createdAt","desc")),h=(await K(s)).docs.map(l=>{var n;return{id:l.id,...l.data(),date:((n=l.data().createdAt)==null?void 0:n.toDate().toLocaleDateString("ko-KR"))||""}}).filter(l=>{var n;return l.category!=="사법뉴스"&&!((n=l.title)!=null&&n.includes("[사법뉴스]"))});D(h),d(h),j(!1)}catch(a){console.error("Error fetching posts:",a),i||d([])}finally{U(!1)}})()},[]);const P=async()=>{if(!(x||!y||!v)){b(!0);try{const t=N(k,"posts"),a=S(t,where("category","!=","사법뉴스"),C("createdAt","desc"),q(v),M(p)),s=await K(a),o=s.docs.map(l=>{var n;return{id:l.id,...l.data(),date:((n=l.data().createdAt)==null?void 0:n.toDate().toLocaleDateString("ko-KR"))||""}}),h=[...m,...o];d(h),D(h),A(s.docs[s.docs.length-1]),j(s.docs.length>=p)}catch(t){console.error("Error loading more posts:",t)}finally{b(!1)}}},g=m.filter(t=>{var a;return t.category!=="사법뉴스"&&!((a=t.title)!=null&&a.includes("[사법뉴스]"))}),w=async t=>{const a=`https://xn--lg3b0kt4n41f.kr/blog/${t.id}`;try{await navigator.clipboard.writeText(a),alert(`링크가 복사되었습니다!
오픈채팅방에 붙여넣기 하세요.`)}catch{alert("링크: "+a)}},R=async t=>{var s;const a=`https://xn--lg3b0kt4n41f.kr/blog/${t.id}`;if(navigator.share)try{const o=`${t.title}

#시민법정 #참심제`;await navigator.share({title:t.title,text:o,url:a});return}catch(o){if(o.name==="AbortError")return;console.log("Web Share failed, trying Kakao:",o)}if(z&&((s=window.Kakao)!=null&&s.isInitialized()))try{window.Kakao.Share.sendDefault({objectType:"feed",content:{title:t.title,description:t.summary||"",imageUrl:"https://xn--lg3b0kt4n41f.kr/og-image.jpg",link:{mobileWebUrl:a,webUrl:a}},buttons:[{title:"더 보기",link:{mobileWebUrl:a,webUrl:a}}]});return}catch(o){console.error("Kakao share error:",o)}w(t)};return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(T,{}),e.jsx("main",{className:"pt-24 pb-16 px-4",children:e.jsxs("div",{className:"container mx-auto max-w-6xl",children:[e.jsx("div",{className:"text-center mb-12",children:e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"블로그"})}),L?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"글을 불러오는 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(t=>e.jsxs("article",{className:"bg-white rounded-xl shadow-md hover:shadow-lg transition-all hover:-translate-y-1 overflow-hidden flex flex-col",children:[t.imageUrl&&t.imageUrl!=="https://siminbupjung-blog.web.app/og-image.jpg"&&e.jsx(u,{to:`/blog/${t.id}`,className:"block",children:e.jsx("div",{className:"aspect-video overflow-hidden",children:e.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})})}),e.jsxs("div",{className:"p-5 flex flex-col flex-1",children:[e.jsx(u,{to:`/blog/${t.id}`,children:e.jsx("h2",{className:"text-lg font-bold text-gray-900 hover:text-blue-600 mb-2 line-clamp-2",children:t.title})}),e.jsx("p",{className:"text-gray-600 text-sm mb-4 line-clamp-4 flex-1",children:t.summary||(t.content?t.content.replace(/<[^>]*>/g,"").slice(0,200):"")}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs("div",{className:"text-xs text-gray-400 mb-3",children:[t.date," · ",t.author]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>w(t),className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",title:"링크 복사",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("button",{onClick:()=>R(t),className:"p-1.5 hover:bg-yellow-50 rounded-full transition-colors",title:"카카오톡 공유",children:e.jsx("svg",{className:"w-4 h-4 text-yellow-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 3c5.799 0 10.5 3.664 10.5 8.185 0 4.52-4.701 8.184-10.5 8.184a13.5 13.5 0 0 1-1.727-.11l-4.408 2.883c-.501.265-.678.236-.472-.413l.892-3.678c-2.88-1.46-4.785-3.99-4.785-6.866C1.5 6.665 6.201 3 12 3zm5.907 8.06l1.47-1.424a.472.472 0 0 0-.656-.678l-1.928 1.866V9.282a.472.472 0 0 0-.944 0v2.557a.471.471 0 0 0 0 .222V13.5a.472.472 0 0 0 .944 0v-1.363l.427-.413 1.428 2.033a.472.472 0 1 0 .773-.543l-1.514-2.155zm-2.958 1.924h-1.46V9.297a.472.472 0 0 0-.943 0v4.159c0 .26.21.472.471.472h1.932a.472.472 0 1 0 0-.944zm-5.857 0h-1.46V9.297a.472.472 0 0 0-.943 0v4.159c0 .26.21.472.471.472h1.932a.472.472 0 1 0 0-.944zm-5.857-1.03h.172l-1.03-2.9c-.093-.261-.44-.197-.44.093l-.001 3.807c0 .26.21.472.471.472h.943a.472.472 0 0 0 0-.944h-.472c.001-.01 0-.018 0-.028v-.5h.028zm7.858-3.754h-1.932a.472.472 0 0 0-.471.472v4.208a.472.472 0 0 0 .943 0v-1.364h1.46a.472.472 0 1 0 0-.944h-1.46v-.928h1.46a.472.472 0 1 0 0-.944z"})})})]}),e.jsx(u,{to:`/blog/${t.id}`,className:"text-blue-600 text-sm font-medium hover:underline",children:"더 보기 →"})]})]})]})]},t.id))}),g.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-500",children:"등록된 글이 없습니다."}),y&&g.length>0&&e.jsx("div",{className:"text-center mt-8",children:e.jsx("button",{onClick:P,disabled:x,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",children:x?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"불러오는 중..."]}):"더 보기"})})]})]})}),e.jsx("footer",{className:"bg-gray-900 text-gray-400 py-6 px-4",children:e.jsx("div",{className:"container mx-auto text-center",children:e.jsx("p",{children:"© 주권자사법개혁추진준비위원회"})})})]})}export{V as default};
